{% extends "layout.html" %}

{% block content %}
<h2>Welcome, {{ user.username }}</h2>

<!-- Profile Picture Section -->
<div style="margin-bottom: 20px;">
    {% if user.profile_pic %}
        <p>Filename: {{ user.profile_pic }}</p>
        <img src="{{ url_for('static', filename='profile_pics/' + user.profile_pic) }}" alt="Profile Picture" width="120" style="border-radius: 50%;">
    {% else %}
        <p>No profile picture uploaded.</p>
    {% endif %}
</div>

<!-- Upload Form -->
<form method="POST" action="{{ url_for('upload_profile_pic') }}" enctype="multipart/form-data" style="margin-bottom: 30px;">
    <input type="file" name="profile_pic" required>
    <button type="submit" class="cart-btn">Upload Profile Picture</button>
</form>

<a href="{{ url_for('logout_user') }}" class="cart-btn">Log out</a>
<a href="{{ url_for('add_car_user') }}" class="cart-btn" style="background-color: green; margin-bottom: 20px;">Add Car for Sale</a>

<hr>

<h2>My Listed Cars</h2>
{% if listed_cars %}
<div class="car-container">
    {% for car in listed_cars %}
        <div class="car-card">
            <img src="{{ url_for('static', filename='uploads/' + car.image) }}" alt="Car Image">
            <h3>{{ car.brand }} {{ car.model }}</h3>
            <p>Price: ${{ car.price }}</p>
            <p>Condition: {{ car.condition }}</p>
        </div>
    {% endfor %}
</div>
{% else %}
    <p>You haven't listed any cars yet.</p>
{% endif %}

<hr>

<h3>My Bookmarked Cars</h3>
{% if user.bookmarked_cars %}
<div class="car-container">
    {% for car in user.bookmarked_cars %}
        <div class="car-card">
            <img src="{{ url_for('static', filename='images/' + car.image) }}" alt="{{ car.brand }} {{ car.model }}">
            <div class="details">
                <h3>{{ car.brand }} {{ car.model }}</h3>
                <p>Year: {{ car.year }}</p>
                <p>Price: ${{ car.price }}</p>
                <form action="{{ url_for('bookmark', car_id=car.id) }}" method="post" style="display:inline;">
                    <button type="submit" class="cart-btn" style="background-color: red;">
                        Remove Bookmark
                    </button>
                </form>
            </div>
        </div>
    {% endfor %}
</div>
{% else %}
    <p>You have no bookmarked cars yet.</p>
{% endif %}

{% endblock %}
